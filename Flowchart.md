# Smart Donation FoodBox – Διάγραμμα Ροής (Mermaid)

> Συμβατό με GitHub Mermaid.  
> Αποφεύγουμε `\n`, παρενθέσεις `()` μέσα σε κόμβους και το en-dash `–` που συχνά σπάνε το parser.

```mermaid
flowchart TD
  A([ΕΚΚΙΝΗΣΗ]) --> B[Αρχικοποίηση συστήματος]
  B --> C[Κλείδωμα όλων των θυρίδων]
  C --> D{Υπάρχει Wi-Fi;}
  D -- ΝΑΙ --> E[Online καταγραφή συμβάντων]
  D -- ΟΧΙ --> F[Offline καταγραφή συμβάντων]
  E --> G[ΑΝΑΜΟΝΗ - LED ΠΡΑΣΙΝΟ]
  F --> G

  %% Συνεχής έλεγχος συνθηκών
  G --> H[Έλεγχος θερμοκρασίας και υγρασίας]
  H --> I{Εκτός ορίων για χρόνο Χ;}
  I -- ΝΑΙ --> J[ΣΥΝΑΓΕΡΜΟΣ - LED ΚΟΚΚΙΝΟ και BUZZER]
  J --> K[Καταγραφή TEMP_ALERT]
  K --> G
  I -- ΟΧΙ --> L[Αναμονή για QR ή παραβίαση]
  L --> M{Σαρώθηκε QR;}

  %% Διαδρομή QR
  M -- ΝΑΙ --> N[Ανάγνωση και ανάλυση QR]
  N --> O{QR έγκυρο;}
  O -- ΟΧΙ --> P[Απόρριψη - LED ΚΟΚΚΙΝΟ αναβόσβημα]
  P --> Q[Καταγραφή QR_FAIL]
  Q --> G

  O -- ΝΑΙ --> R[Επιλογή διαθέσιμης θυρίδας]
  R --> S{Υπάρχει διαθέσιμη θυρίδα;}
  S -- ΟΧΙ --> T[Μήνυμα NO SLOT - LED ΚΙΤΡΙΝΟ]
  T --> U[Καταγραφή NO_AVAILABLE]
  U --> G

  S -- ΝΑΙ --> V[Έλεγχος θυρίδας - πόρτα κλειστή και ασφαλής]
  V --> W{Θυρίδα ΟΚ;}
  W -- ΟΧΙ --> X[Παράλειψη θυρίδας]
  X --> Y[Καταγραφή COMPARTMENT_UNSAFE]
  Y --> R

  W -- ΝΑΙ --> Z[Ξεκλείδωμα θυρίδας - servo ή solenoid]
  Z --> AA[LED ΜΠΛΕ - θυρίδα ανοιχτή]
  AA --> AB{Έκλεισε η πόρτα;}
  AB -- ΝΑΙ --> AC[Κλείδωμα θυρίδας]
  AC --> AD[Καταγραφή QR_OK και OPEN_CLOSE]
  AD --> G

  AB -- ΟΧΙ --> AE{Έληξε ο χρόνος;}
  AE -- ΟΧΙ --> AB
  AE -- ΝΑΙ --> AF[Πόρτα ανοιχτή πολύ - BUZZER και LED ΚΟΚΚΙΝΟ]
  AF --> AG[Καταγραφή TIMEOUT]
  AG --> AH{Έκλεισε τελικά;}
  AH -- ΝΑΙ --> AC
  AH -- ΟΧΙ --> AI[Κλιμάκωση - συνεχής συναγερμός]
  AI --> AJ[Απαιτείται reset διαχειριστή]
  AJ --> G

  %% Παραβίαση
  M -- ΟΧΙ --> AK{Άνοιγμα πόρτας χωρίς έγκυρο QR;}
  AK -- ΟΧΙ --> G
  AK -- ΝΑΙ --> AL[ΠΑΡΑΒΙΑΣΗ - LED ΚΟΚΚΙΝΟ και BUZZER]
  AL --> AM[Καταγραφή TAMPER]
  AM --> AN[Κλείδωμα όλων και ειδοποίηση διαχειριστή]
  AN --> G
